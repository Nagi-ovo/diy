## 3.6 跳转指令与循环

用数据的条件转移带来代理控制的条件转移：
![[storage bag/Screenshot 2023-11-24 at 09.10.09.png]]
> 为什么右侧的写法执行效率更高呢？

![](storage%20bag/Screenshot%202023-11-24%20at%2009.12.06.png)
> 满足规定条件时，将寄存器rdx中的数据复制到寄存器rax内。
> 勘误：cmpq和cmovge的操作数顺序写反了
### 为什么基于条件传送的代码会比基于跳转指令的代码效率高？

这里涉及到现代处理器通过**流水线**来获得高性能。
遇到跳转指令时，处理器会根据分支预测器来才做每条跳转指令是否执行，发生错误预测时则会浪费大量时间，导致程序性能严重下降。

 ### 循环结构
 
C语言提供了三种循环结构：`do-while`、`while`和`for`

汇编语言中，循环语句是通过条件测试与跳转的组合来实现的

![[storage bag/Screenshot 2023-11-24 at 09.29.05.png]]
> `cmp` + `jump`，循环体的内容至少执行一次

除了一种极端情况外，下面的for循环和while循环功能是一样的
![](storage%20bag/Screenshot%202023-11-24%20at%2009.32.00.png)

![[storage bag/Screenshot 2023-11-25 at 16.29.11.png]]
> 除了最后的跳转指令有区别外，其它部分都是一致的。
> 两个汇编代码都是采用`-OG`选项产生的

C语言中还有`switch`语句，在针对一个有多种可能结果的测试时很有用，使用**跳转表**来实现。
![[storage bag/Screenshot 2023-11-25 at 16.32.49.png]]
使用跳转表的优点：执行switch语句的**时间与case的数量无关**，因此在处理多重分支上，会比一大串if else语句执行效率高一些。