## 3.4 算术和逻辑运算指令
### leaq

`leaq` 是 "Load Effective Address Quad-word" 的缩写。它计算一个内存地址，但不是从这个地址读取数据，而是将计算出来的地址本身存储起来。这个指令常用于进行地址计算或简单的算数操作。

![[storage bag/Screenshot 2023-11-16 at 21.26.06.png]]

还可以用来表示加法和有限的乘法运算，

![[storage bag/Screenshot 2023-11-16 at 21.34.42.png]]
> 这里不能如红色代码所示直接一步得到结果的原因是，前面说过的：比例因子取值只能是1、2、4、8中的一个，所以需要分解12。
> [[03 程序的机器级表示#^cb8c4a]]

### Unary Operation(一元操作)
| Instruction | Effect    | Description |
|-------------|-----------|-------------|
| INC D       | $D ← D + 1$ | Increment (加1)   |
| DEC D       | $D ← D - 1$ | Decrement (减1)   |
| NEG D       | $D ← -D$    | Negate (取反)     |
| NOT D       | $D ←  {\sim}D$    | Complement (取补) |
> 操作数可以是寄存器或者内存地址

| Instruction | Effect               | Description         |
| ----------- | -------------------- | ------------------- |
| ADD S,D     | $D ← D + S$          | ADD (加)            |
| SUB S,D     | $D ← D - S$          | Subtract (减)       |
| IMUL S,D    | $D ← D * S$          | Multiply (乘)       |
| XOR S,D     | $D ← D\ {^\wedge}\ S$ | Exclusive-or (异或) |
| OR S,D      | $D ← D\ \|\ S$       | Or (或)             |
| AND S,D     | $D ← D\ \&\ S$         | And (与)            |

![[storage bag/Screenshot 2023-11-16 at 22.23.02.png]]

![[storage bag/Screenshot 2023-11-16 at 22.25.39.png]]

### 移位操作
| Instruction | Effect   | Description           |
|-------------|----------|-----------------------|
| SAL k, D    | $D ← D << k$ | Left shift (左移)     |
| SHL k, D    | $D ← D << k$ | Left shift (左移，等同于 SAL) |
| SAR k, D    | $D ← D >>_A k$ | Arithmetic right shift (算术右移) |
| SHR k, D    | $D ← D >>_Lk$ | Logical right shift (逻辑右移)   |
> 对于移位量k，可以是一个立即数，或者是存放在寄存器`cl`中的数（移位指令**只允许**以特定的寄存器cl作为操作数）

寄存器cl的长度为8，原则上移位量的编码范围可达$2^8-1$(255)
实际上，对于w位的操作数进行移位操作，移位量是由寄存器cl的低m位来决定的。

![[storage bag/Screenshot 2023-11-20 at 19.41.24.png]]
